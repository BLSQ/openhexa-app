{% load date_utils embed i18n static %}

{% embed "core/components/card/card.html" %}
    {% slot heading %}
        {% with title=instance.name subtitle=instance.description|default:_("No description") symbol_alt=_("DHIS2") %}
            {% static "connector_dhis2/img/symbol.svg"  as symbol_src %}
            {% embed "core/components/card/heading_with_image_and_actions.html" with title=title subtitle=subtitle image_src=symbol_src image_alt=symbol_alt %}
                {% slot actions %}
                    {% url "connector_dhis2:instance_sync" instance.pk as sync_url %}
                    {% embed "core/components/card/heading_action.html" with url=sync_url label=_("Sync") %}
                        {% slot icon %}
                            {% include "core/components/icons/refresh.html" %}
                        {% endslot %}
                    {% endembed %}
                    {% embed "core/components/card/heading_action.html" with label=_("Edit") %}
                        {% slot icon %}
                            {% include "core/components/icons/pencil_alt.html" %}
                        {% endslot %}
                    {% endembed %}
                {% endslot %}
            {% endembed %}
        {% endwith %}
    {% endslot %}
    {% slot content %}
        {% embed "core/components/description_list/list.html" %}
            {% slot content %}
                {# Name #}
                {% embed "core/components/description_list/item.html" with term=_("Instance name") %}
                    {% slot definition %}{{ instance.name }}{% endslot %}
                {% endembed %}
                {# URL #}
                {% embed "core/components/description_list/item.html" with term=_("URL") %}
                    {% slot definition %}
                        {% if instance.url %}
                            {% include "core/components/description_list/item_link.html" with url=instance.url label=instance.url %}
                        {% else %}
                            -
                        {% endif %}
                    {% endslot %}
                {% endembed %}
                {# Content #}
                {% embed "core/components/description_list/item.html" with term=_("Content") %}
                    {% slot definition %}
                        {{ instance.content_summary|default:"-" }}
                    {% endslot %}
                {% endembed %}
                {# Location #}
                {% embed "core/components/description_list/item.html" with term=_("Location") %}
                    {% slot definition %}
                        {% include "core/components/description_list/item_location.html" with countries=instance.countries %}
                    {% endslot %}
                {% endembed %}
                {# Owner #}
                {% embed "core/components/description_list/item.html" with term=_("Owner") %}
                    {% slot definition %}
                        {% if instance.owner %}
                            {{ instance.owner.name }}
                            ({{ instance.owner.get_organization_type_display }})
                            {% if instance.owner.url %}
                                {% include "core/components/description_list/item_link.html" with url=instance.owner.url label=_("Official website") %}
                            {% endif %}
                        {% else %}
                            -
                        {% endif %}
                    {% endslot %}
                {% endembed %}
                {# Contact #}
                {% embed "core/components/description_list/item.html" with term=_("Contact") %}
                    {% slot definition %}
                        {% if instance.owner.contact_info %}
                            {{ instance.owner.contact_info|linebreaks|urlize }}
                        {% else %}
                            -
                        {% endif %}
                    {% endslot %}
                {% endembed %}
                {# Tags #}
                {% embed "core/components/description_list/item.html" with term=_("Tags") %}
                    {% slot definition %}
                        {% include "core/components/description_list/item_tags.html" with tags=instance.tags %}
                    {% endslot %}
                {% endembed %}
                {# Last sync #}
                {% embed "core/components/description_list/item.html" with term=_("Last synced") %}
                    {% slot definition %}
                        {{ instance.last_synced_at|date_format|default:_("Never") }}
                    {% endslot %}
                {% endembed %}
            {% endslot %}
        {% endembed %}
    {% endslot %}
{% endembed %}
