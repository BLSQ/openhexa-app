{% load date_utils embed i18n static %}

{% embed "core/components/section/page_section.html" %}
    {% slot header %}
        {% include "core/components/section/section_heading_simple.html" with title=_("DAG configurations") %}
    {% endslot %}
    {% slot content %}
        {% embed "core/components/table/table.html" %}
            {% slot header_cells %}
                {% include "core/components/table/header_cell.html" with label=_("Name") %}
                {% include "core/components/table/header_cell.html" with label=_("Content") %}
                {% include "core/components/table/header_cell.html" with label=_("Last run at") %}
                {% include "core/components/table/header_cell.html" with label=_("Last run state") %}
                {% include "core/components/table/header_cell.html" with label=_("Actions") sr_only=True %}
            {% endslot %}
            {% slot rows %}
                {% for config in dag_configs %}
                    {% url "connector_airflow:dag_config_detail" config.dag.cluster.pk config.dag.pk config.pk as detail_url %}
                    {% url "connector_airflow:dag_config_run" config.dag.cluster.pk config.dag.pk config.pk as run_url %}
                    <tr>
                        {# Name #}
                        {% include "core/components/table/cell_first.html" with url=detail_url label=config.name %}
                        {# Content #}
                        {% include "core/components/table/cell.html" with label=config.content_summary %}
                        {# Last executed at #}
                        {% include "core/components/table/cell.html" with label=config.last_executed_at|date_format|default:_("Never") %}
                        {# Last run state #}
                        {% include "core/components/table/cell.html" with label=config.last_run_state|default:"-" %}
                        {# Actions #}
                        {% include "core/components/table/cell_action.html" with url=run_url label=_("Run") icon="chevron_right" %}
                    </tr>
                {% empty %}
                    {% include "core/components/table/cell_empty.html" with colspan=5 %}
                {% endfor %}
            {% endslot %}
        {% endembed %}
    {% endslot %}
{% endembed %}