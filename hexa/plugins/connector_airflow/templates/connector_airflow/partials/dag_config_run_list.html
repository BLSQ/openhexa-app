{% load date_utils embed i18n static %}

{% embed "core/components/section/page_section.html" %}
    {% slot header %}
        {% include "core/components/section/section_heading_simple.html" with title=_("DAG configuration run") %}
    {% endslot %}
    {% slot content %}
        {% embed "core/components/table/table.html" %}
            {% slot header_cells %}
                {% include "core/components/table/header_cell.html" with label=_("Run ID") %}
                {% include "core/components/table/header_cell.html" with label=_("State") %}
                {% include "core/components/table/header_cell.html" with label=_("Execution date") %}
                {% include "core/components/table/header_cell.html" with label=_("Last refreshed at") %}
                {% include "core/components/table/header_cell.html" with label=_("Actions") sr_only=True %}
            {% endslot %}
            {% slot rows %}
                {% for run in dag_config_runs %}
                    {% url "connector_airflow:dag_config_run_detail" run.dag_config.dag.environment.pk run.dag_config.dag.pk run.dag_config.pk run.pk as detail_url %}
                    {% url "connector_airflow:dag_config_run_status" run.dag_config.dag.environment.pk run.dag_config.dag.pk run.dag_config.pk run.pk as status_url %}
                    <tr>
                        {# Run ID #}
                        {% include "core/components/table/cell_first.html" with url=detail_url label=run.run_id %}
                        {# State #}
                        {% include "core/components/table/cell.html" with label=run.state|default:"Unknown" %}
                        {# Execution date #}
                        {% include "core/components/table/cell.html" with label=run.execution_date|format_date %}
                        {# Last refreshed at #}
                        {% include "core/components/table/cell.html" with label=run.hexa_last_refreshed_at|format_date|default:_("Never") %}
                        {# Actions #}
                        {% include "core/components/table/cell_action.html" with url=status_url label=_("Refresh") icon="refresh" %}
                    </tr>
                {% empty %}
                    {% include "core/components/table/cell_empty.html" with colspan=5 %}
                {% endfor %}
            {% endslot %}
        {% endembed %}
    {% endslot %}
{% endembed %}