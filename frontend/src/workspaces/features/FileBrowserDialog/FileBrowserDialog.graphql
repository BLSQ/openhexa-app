query FileBrowserDialog(
  $slug: String!
  $page: Int
  $perPage: Int
  $prefix: String
  $query: String!
  $workspaceSlugs: [String!]
  $useSearch: Boolean!
) {
  # Root-level searchFiles query for search mode
  searchResults: searchFiles(
    query: $query
    workspaceSlugs: $workspaceSlugs
    page: $page
    perPage: $perPage
  ) @include(if: $useSearch) {
    totalItems
    totalPages
    pageNumber
    items {
      file {
        name
        key
        path
        type
        updated
        size
      }
      score
    }
  }

  # Workspace-level bucket.objects for directory browsing
  workspace(slug: $slug) @skip(if: $useSearch) {
    slug
    bucket {
      objects(page: $page, perPage: $perPage, prefix: $prefix) {
        items {
          name
          key
          path
          type
          updatedAt
          size
          ...FileBrowserDialog_bucketObject
        }
        pageNumber
        hasNextPage
        hasPreviousPage
      }
    }
  }
}

fragment FileBrowserDialog_bucketObject on BucketObject {
  key
  name
  path
  size
  updatedAt
  type
}
