type AssistantConversation {
  id: UUID!
  createdAt: DateTime!
  updatedAt: DateTime!
  model: String!
  messages: [AssistantMessage!]!
  totalInputTokens: Int!
  totalOutputTokens: Int!
  estimatedCost: Float!
}

type AssistantMessage {
  id: UUID!
  role: String!
  content: String!
  createdAt: DateTime!
  inputTokens: Int
  outputTokens: Int
  cost: Float
  toolName: String
  toolInput: JSON
}

type PendingToolCall {
  id: UUID!
  toolName: String!
  toolInput: JSON!
  createdAt: DateTime!
}

enum SendAssistantMessageStatus {
  COMPLETE
  AWAITING_APPROVAL
}

type SendAssistantMessageResult {
  success: Boolean!
  status: SendAssistantMessageStatus!
  message: AssistantMessage
  errors: [SendAssistantMessageError!]!
  usage: AssistantUsage
  pendingToolCall: PendingToolCall
}

type AssistantUsage {
  inputTokens: Int!
  outputTokens: Int!
  cost: Float!
}

enum SendAssistantMessageError {
  PERMISSION_DENIED
  CONVERSATION_NOT_FOUND
  EMPTY_MESSAGE
  AGENT_ERROR
  ASSISTANT_DISABLED
}

input SendAssistantMessageInput {
  conversationId: UUID
  workspaceSlug: String!
  message: String!
}

type DeleteAssistantConversationResult {
  success: Boolean!
  errors: [DeleteAssistantConversationError!]!
}

enum DeleteAssistantConversationError {
  PERMISSION_DENIED
  NOT_FOUND
}

input DeleteAssistantConversationInput {
  id: UUID!
}

input ApproveToolExecutionInput {
  pendingToolCallId: UUID!
  approved: Boolean!
}

type ApproveToolExecutionResult {
  success: Boolean!
  status: SendAssistantMessageStatus!
  message: AssistantMessage
  errors: [ApproveToolExecutionError!]!
  usage: AssistantUsage
  pendingToolCall: PendingToolCall
}

enum ApproveToolExecutionError {
  PERMISSION_DENIED
  NOT_FOUND
  ALREADY_PROCESSED
  AGENT_ERROR
}

type AssistantModelConfig {
  id: String!
  label: String!
}

extend type Query {
  assistantModels: [AssistantModelConfig!]! @loginRequired
}

extend type Workspace {
  assistantEnabled: Boolean!
  assistantConversations: [AssistantConversation!]!
}

extend type Mutation {
  sendAssistantMessage(input: SendAssistantMessageInput!): SendAssistantMessageResult! @loginRequired
  deleteAssistantConversation(input: DeleteAssistantConversationInput!): DeleteAssistantConversationResult! @loginRequired
  approveToolExecution(input: ApproveToolExecutionInput!): ApproveToolExecutionResult! @loginRequired
}
